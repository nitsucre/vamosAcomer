<?php App::import('Lib', 'functions'); //imports app/libs/functions ?>
<div class="recettes view">
<h2><?php  __('Recette');?></h2>
	<dl><?php $i = 0; $class = ' class="altrow"';?>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Country'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $this->Html->link($recette['Country']['name'], array('controller' => 'countries', 'action' => 'view', $recette['Country']['id'])); ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Titre'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['titre']; ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Temps'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['temps']; ?>
			&nbsp;
		</dd>
		
			<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Ingrédients'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php 
			ingredients($recette['Recette']['id']);
			?>
			&nbsp;
		</dd>
		
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Commentaire'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['ingr']; ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Pers'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['pers']; 
			nombre_personnes($recette['Recette']['id'],$recette['Recette']['pers']);
			?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Type'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $this->Html->link($recette['Type']['name'], array('controller' => 'types', 'action' => 'view', $recette['Type']['id'])); ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('User'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $this->Html->link($recette['User']['email'], array('controller' => 'users', 'action' => 'view', $recette['User']['id'])); ?>
			&nbsp;
		</dd>
		
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Etapes'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php $etapes=etapes($recette['Recette']['id'],$session->read('Auth.User.role')); 
			echo $etapes;
			

/*	hide from non-admin registred user */
	if($session->read('Auth.User.role')=="administrator") {
		echo "&nbsp;<a href=\"".CHEMIN ."etapes/add/?recette=".$recette['Recette']['id'] ."\">Ajouter une étape</a>";
}
?>

		
			&nbsp;
		</dd>
		
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Prep'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['prep']; 
			?>
		
			&nbsp;
		</dd>
		 
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Date'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['date']; ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Score'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['score']; ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Source'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['source']; ?>
			&nbsp;
		</dd>
		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Pict'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<!--  todo fix img repos -->
			<img src="http://www.akademia.ch/recettes2/img/pics/
				<?php echo $recette['Recette']['pict']; ?>
			">
			&nbsp;
		</dd>
<?php
############## ADMIN AREA ##################
/*	hide from non-admin registred user */
	if($session->read('Auth.User.role')=="administrator") {
?>		<dt<?php if ($i % 2 == 0) echo $class;?>><?php __('Private'); ?></dt>
		<dd<?php if ($i++ % 2 == 0) echo $class;?>>
			<?php echo $recette['Recette']['private']; ?>
			&nbsp;
		</dd>
<?
	}
//end hide from non-admin registred user
?>
	</dl>
</div>
<?php
############## ADMIN AREA ##################
/*	hide from non-admin registred user */
	if($session->read('Auth.User.role')=="administrator") {
?>
<div class="actions">
	<h3><?php __('Actions'); ?></h3>
	<ul>
		<li><?php echo $this->Html->link(__('Edit Recette', true), array('action' => 'edit', $recette['Recette']['id'])); ?> </li>
		<li><?php echo $this->Html->link(__('Delete Recette', true), array('action' => 'delete', $recette['Recette']['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $recette['Recette']['id'])); ?> </li>
		<li><?php echo $this->Html->link(__('List Recettes', true), array('action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Recette', true), array('action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Countries', true), array('controller' => 'countries', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Country', true), array('controller' => 'countries', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Types', true), array('controller' => 'types', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Type', true), array('controller' => 'types', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Users', true), array('controller' => 'users', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New User', true), array('controller' => 'users', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Menus', true), array('controller' => 'menus', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Menu', true), array('controller' => 'menus', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Stats', true), array('controller' => 'stats', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Stat', true), array('controller' => 'stats', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Etapes', true), array('controller' => 'etapes', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Etape', true), array('controller' => 'etapes', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Ingredients', true), array('controller' => 'ingredients', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Ingredient', true), array('controller' => 'ingredients', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Modecuissons', true), array('controller' => 'modecuissons', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Modecuisson', true), array('controller' => 'modecuissons', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Orthographes', true), array('controller' => 'orthographes', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Orthographe', true), array('controller' => 'orthographes', 'action' => 'add')); ?> </li>
		<li><?php echo $this->Html->link(__('List Saisons', true), array('controller' => 'saisons', 'action' => 'index')); ?> </li>
		<li><?php echo $this->Html->link(__('New Saison', true), array('controller' => 'saisons', 'action' => 'add')); ?> </li>
	</ul>
</div>

<div class="related">
	<h3><?php __('Related Menus');?></h3>
	<?php if (!empty($recette['Menu'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Identifiantmenu'); ?></th>
		<th><?php __('Recette Id'); ?></th>
		<th><?php __('Rem'); ?></th>
		<th class="actions"><?php __('Actions');?></th>
	</tr>
	<?php
		$i = 0;
		foreach ($recette['Menu'] as $menu):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $menu['id'];?></td>
			<td><?php echo $menu['identifiantmenu'];?></td>
			<td><?php echo $menu['recette_id'];?></td>
			<td><?php echo $menu['rem'];?></td>
			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'menus', 'action' => 'view', $menu['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'menus', 'action' => 'edit', $menu['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'menus', 'action' => 'delete', $menu['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $menu['id'])); ?>
			</td>
		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Menu', true), array('controller' => 'menus', 'action' => 'add'));?> </li>
		</ul>
	</div>

	
</div>

<div class="related">
	<h3><?php __('Related Stats');?></h3>
	<?php if (!empty($recette['Stat'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Recette Id'); ?></th>
		<th><?php __('User Id'); ?></th>
		<th><?php __('Ip'); ?></th>
		<th><?php __('Date'); ?></th>
		<th class="actions"><?php __('Actions');?></th>
	</tr>
	<?php
		$i = 0;
		foreach ($recette['Stat'] as $stat):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $stat['id'];?></td>
			<td><?php echo $stat['recette_id'];?></td>
			<td><?php echo $stat['user_id'];?></td>
			<td><?php echo $stat['ip'];?></td>
			<td><?php echo $stat['date'];?></td>
			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'stats', 'action' => 'view', $stat['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'stats', 'action' => 'edit', $stat['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'stats', 'action' => 'delete', $stat['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $stat['id'])); ?>
			</td>
		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Stat', true), array('controller' => 'stats', 'action' => 'add'));?> </li>
		</ul>
	</div>
</div>

<div class="related">
	<h3><?php __('Related Etapes');?></h3>
	<?php if (!empty($recette['Etape'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Order'); ?></th>
		<th><?php __('Text'); ?></th>
		<th><?php __('Url'); ?></th>
		<th><?php __('Image'); ?></th>
		<th><?php __('Sound'); ?></th>
		<th><?php __('Video'); ?></th>
		<th><?php __('Notes'); ?></th>
<th>Déplacer</th>
		<th class="actions"><?php __('Actions');?></th>

	</tr>
	<?php
		$i = 0;
		foreach ($recette['Etape'] as $etape):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $etape['id'];?></td>
			<td><?php echo $etape['order'];?></td>
			<td><?php echo $etape['text'];?></td>
			<td><?php echo $etape['url'];?></td>
			<td><?php echo $etape['image'];?></td>
			<td><?php echo $etape['sound'];?></td>
			<td><?php echo $etape['video'];?></td>
			<td><?php echo $etape['notes'];?></td>
<td>
<?
echo "<a href=\"". CHEMIN ."etapes/deplacer?recette_id=".$recette['Recette']['id'] ."&etape_id=" .$etape['id'] ."&dir=up\">";
echo $html->image('icons/up.jpg', array("alt"=>"Déplacer vers le haut","title"=>"Déplacer vers le haut"));
echo "&nbsp;</a>";
?>
<br/>
		<?
echo "<a href=\"". CHEMIN ."etapes/deplacer?recette_id=".$recette['Recette']['id'] ."&etape_id=" .$etape['id'] ."&dir=down\">";
echo $html->image('icons/down.jpg', array("alt"=>"Déplacer vers le bas","title"=>"Déplacer vers le bas"));
echo "&nbsp;</a>";
?>
		</td>
			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'etapes', 'action' => 'view', $etape['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'etapes', 'action' => 'edit', $etape['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'etapes', 'action' => 'delete', $etape['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $etape['id'])); ?>
			</td>

		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Etape', true), array('controller' => 'etapes', 'action' => 'add'));?> </li>
		</ul>
	</div>

</div>
<div class="related">
	<h3><?php __('Related Ingredients');?></h3>
	<?php if (!empty($recette['Ingredient'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Libelle'); ?></th>
		<th><?php __('Typ'); ?></th>
		<th><?php __('Unit'); ?></th>
		<th><?php __('Kcal'); ?></th>
		<th><?php __('Price'); ?></th>
		<th><?php __('Img'); ?></th>
		<th><?php __('Commissions'); ?></th>

		<th class="actions"><?php __('Actions');?></th>

	</tr>
	<?php
		$i = 0;
		foreach ($recette['Ingredient'] as $ingredient):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $ingredient['id'];?></td>
			<td><?php echo $ingredient['libelle'];?></td>
			<td><?php echo $ingredient['typ'];?></td>
			<td><?php echo $ingredient['unit'];?></td>
			<td><?php echo $ingredient['kcal'];?></td>
			<td><?php echo $ingredient['price'];?></td>
			<td>
			<?php echo $ingredient['img'];?>
			
			</td>
			<td><?php echo $ingredient['commissions'];?></td>

			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'ingredients', 'action' => 'view', $ingredient['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'ingredients', 'action' => 'edit', $ingredient['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'ingredients', 'action' => 'delete', $ingredient['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $ingredient['id'])); ?>
			</td>

		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Ingredient', true), array('controller' => 'ingredients', 'action' => 'add'));?> </li>
		</ul>
	</div>
</div>
<div class="related">
	<h3><?php __('Related Modecuissons');?></h3>
	<?php if (!empty($recette['Modecuisson'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Parent'); ?></th>
		<th><?php __('Lib'); ?></th>
		<th><?php __('Rem'); ?></th>

		<th class="actions"><?php __('Actions');?></th>

	</tr>
	<?php
		$i = 0;
		foreach ($recette['Modecuisson'] as $modecuisson):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $modecuisson['id'];?></td>
			<td><?php echo $modecuisson['parent'];?></td>
			<td><?php echo $modecuisson['lib'];?></td>
			<td><?php echo $modecuisson['rem'];?></td>

			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'modecuissons', 'action' => 'view', $modecuisson['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'modecuissons', 'action' => 'edit', $modecuisson['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'modecuissons', 'action' => 'delete', $modecuisson['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $modecuisson['id'])); ?>
			</td>

		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Modecuisson', true), array('controller' => 'modecuissons', 'action' => 'add'));?> </li>
		</ul>
	</div>

</div>

<div class="related">
	<h3><?php __('Related Orthographes');?></h3>
	<?php if (!empty($recette['Orthographe'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Orthographe'); ?></th>
		<th><?php __('Aurtograf'); ?></th>
		<th><?php __('Id'); ?></th>
		<th class="actions"><?php __('Actions');?></th>
	</tr>
	<?php
		$i = 0;
		foreach ($recette['Orthographe'] as $orthographe):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $orthographe['orthographe'];?></td>
			<td><?php echo $orthographe['aurtograf'];?></td>
			<td><?php echo $orthographe['id'];?></td>
			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'orthographes', 'action' => 'view', $orthographe['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'orthographes', 'action' => 'edit', $orthographe['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'orthographes', 'action' => 'delete', $orthographe['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $orthographe['id'])); ?>
			</td>
		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Orthographe', true), array('controller' => 'orthographes', 'action' => 'add'));?> </li>
		</ul>
	</div>
</div>

<div class="related">
	<h3><?php __('Related Saisons');?></h3>
	<?php if (!empty($recette['Saison'])):?>
	<table cellpadding = "0" cellspacing = "0">
	<tr>
		<th><?php __('Id'); ?></th>
		<th><?php __('Saison'); ?></th>

		<th class="actions"><?php __('Actions');?></th>

	</tr>
	<?php
		$i = 0;
		foreach ($recette['Saison'] as $saison):
			$class = null;
			if ($i++ % 2 == 0) {
				$class = ' class="altrow"';
			}
		?>
		<tr<?php echo $class;?>>
			<td><?php echo $saison['id'];?></td>
			<td><?php echo $saison['saison'];?></td>

			<td class="actions">
				<?php echo $this->Html->link(__('View', true), array('controller' => 'saisons', 'action' => 'view', $saison['id'])); ?>
				<?php echo $this->Html->link(__('Edit', true), array('controller' => 'saisons', 'action' => 'edit', $saison['id'])); ?>
				<?php echo $this->Html->link(__('Delete', true), array('controller' => 'saisons', 'action' => 'delete', $saison['id']), null, sprintf(__('Are you sure you want to delete # %s?', true), $saison['id'])); ?>
			</td>

		</tr>
	<?php endforeach; ?>
	</table>
<?php endif; ?>

	<div class="actions">
		<ul>
			<li><?php echo $this->Html->link(__('New Saison', true), array('controller' => 'saisons', 'action' => 'add'));?> </li>
		</ul>
	</div>
<?
	}
//end hide from non-admin registred user
?>
</div>
